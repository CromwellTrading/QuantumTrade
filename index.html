<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Signal Trader Pro</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="particles" id="particles"></div>
    
    <div class="container">
        <header>
            <div>
                <!-- Display del ID del usuario -->
                <div id="userIdDisplay" class="user-id-display">ID: Cargando...</div>
                <h1>QUANTUM SIGNAL TRADER PRO</h1>
                <p class="header-subtitle">Sistema de Señales para Opciones Binarias</p>
            </div>
            <div class="header-controls">
                <button class="header-btn active" id="showSignals"><i class="fas fa-broadcast-tower"></i> Señales</button>
                <button class="header-btn" id="showStats"><i class="fas fa-chart-bar"></i> Estadísticas</button>
                <button class="header-btn" id="showUsers" style="display: none;"><i class="fas fa-users"></i> Usuarios</button>
                <button class="header-btn vip" id="vipAccess"><i class="fas fa-crown"></i> VIP</button>
                <button class="header-btn" id="adminBtn" style="display: none;"><i class="fas fa-user-shield"></i> Admin</button>
            </div>
        </header>
        
        <div class="connection-status" id="connectionStatus">
            <div class="status-dot status-connected" id="statusDot"></div>
            <span id="statusText">Conectado al servidor</span>
        </div>
        
        <div class="session-info" id="sessionInfo">
            <i class="fas fa-clock"></i> Sesión inactiva - Inicia una sesión para comenzar
        </div>
        
        <div class="grid">
            <div class="panel admin-panel" id="adminPanel" style="display: none;">
                <h3><i class="fas fa-user-shield"></i> Panel de Control Administrativo</h3>
                
                <!-- Gestión de Usuarios VIP -->
                <div class="user-management-section">
                    <h4><i class="fas fa-users-cog"></i> Gestión de Usuarios VIP</h4>
                    
                    <div class="form-group">
                        <label for="userSearchInput"><i class="fas fa-search"></i> Buscar Usuario por ID de Telegram</label>
                        <div class="search-container">
                            <input type="text" id="userSearchInput" placeholder="Ej: 123456789">
                            <button id="searchUserBtn" class="search-btn"><i class="fas fa-search"></i> Buscar</button>
                        </div>
                    </div>
                    
                    <div id="userSearchResult" class="user-search-result" style="display: none;">
                        <!-- Los resultados de búsqueda aparecerán aquí -->
                    </div>
                    
                    <div class="user-actions" id="userActions" style="display: none;">
                        <button id="makeVipBtn" class="admin-btn btn-vip"><i class="fas fa-crown"></i> Hacer VIP</button>
                        <button id="removeVipBtn" class="admin-btn btn-loss"><i class="fas fa-times"></i> Quitar VIP</button>
                    </div>
                </div>

                <div class="form-group">
                    <label for="asset"><i class="fas fa-chart-line"></i> Activo</label>
                    <input type="text" id="asset" placeholder="Ej: EUR/USD, BTC/USD, etc.">
                </div>
                <div class="form-group">
                    <label for="timeframe"><i class="fas fa-clock"></i> Tiempo</label>
                    <select id="timeframe">
                        <option value="1">1 minuto</option>
                        <option value="2">2 minutos</option>
                        <option value="5">5 minutos</option>
                        <option value="15">15 minutos</option>
                        <option value="30">30 minutos</option>
                        <option value="60">1 hora</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="direction"><i class="fas fa-arrows-alt-v"></i> Dirección</label>
                    <select id="direction">
                        <option value="up">ALZA (CALL)</option>
                        <option value="down">BAJA (PUT)</option>
                    </select>
                </div>
                <button id="sendSignal"><i class="fas fa-paper-plane"></i> ENVIAR SEÑAL</button>
                <div class="admin-controls" style="margin-top: 20px;">
                    <button id="startSession" class="admin-btn btn-profit"><i class="fas fa-play"></i> Iniciar Sesión</button>
                    <button id="endSession" class="admin-btn btn-loss" disabled><i class="fas fa-stop"></i> Finalizar Sesión</button>
                </div>
                <div class="admin-controls" style="margin-top: 10px;">
                    <button id="notifyClients" class="admin-btn btn-notify"><i class="fas fa-bell"></i> Avisar al Cliente (10 min)</button>
                </div>
            </div>
            
            <div class="panel signals-panel">
                <h3><i class="fas fa-broadcast-tower"></i> Señales Activas</h3>
                <button id="readyBtn" class="ready-btn">
                    <i class="fas fa-bell"></i> PREPARADOS
                </button>
                <div class="user-status" id="userStatus">
                    <div class="session-info">
                        <i class="fas fa-user"></i> Estado: Cargando información del usuario...
                    </div>
                </div>
                <div id="signalsContainer">
                    <div class="empty-state">
                        <i class="fas fa-satellite-dish"></i>
                        <p>Esperando señales de trading...</p>
                        <p>Las señales aparecerán aquí automáticamente</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="stats-container" id="statsContainer">
            <div class="panel stats-panel">
                <h3><i class="fas fa-chart-bar"></i> Estadísticas de Trading</h3>
                
                <div class="time-filters">
                    <button class="time-filter active" data-period="day">Hoy</button>
                    <button class="time-filter" data-period="week">Esta Semana</button>
                    <button class="time-filter" data-period="month">Este Mes</button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Operaciones Ganadas</div>
                        <div class="stat-value stat-profit" id="winCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Operaciones Perdidas</div>
                        <div class="stat-value stat-loss" id="lossCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Operaciones</div>
                        <div class="stat-value stat-total" id="totalCount">0</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
                
                <h3 style="margin-top: 30px;"><i class="fas fa-history"></i> Historial de Operaciones</h3>
                <div style="overflow-x: auto;">
                    <table class="operations-table">
                        <thead>
                            <tr>
                                <th>Activo</th>
                                <th>Dirección</th>
                                <th>Tiempo</th>
                                <th>Estado</th>
                                <th>Fecha</th>
                            </tr>
                        </thead>
                        <tbody id="operationsTable">
                            <!-- Las operaciones se insertarán aquí -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="users-container" id="usersContainer">
            <div class="panel users-panel">
                <h3><i class="fas fa-users"></i> Gestión de Usuarios</h3>
                
                <div class="admin-controls" style="margin-bottom: 20px;">
                    <button id="refreshUsers" class="admin-btn btn-profit"><i class="fas fa-sync-alt"></i> Actualizar Lista</button>
                </div>
                
                <div style="overflow-x: auto;">
                    <table class="users-table">
                        <thead>
                            <tr>
                                <th>ID de Telegram</th>
                                <th>Usuario</th>
                                <th>Estado VIP</th>
                                <th>Expiración VIP</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- Los usuarios se cargarán aquí -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification">
        <i class="fas fa-bell"></i> Nueva señal recibida!
    </div>
    
    <div class="signal-alert" id="signalAlert">
        <div class="asset" id="alertAsset">EUR/USD</div>
        <div class="direction up" id="alertDirection">
            <span class="arrow up">↑</span>
            <span>ALZA (CALL)</span>
        </div>
        <div class="time-remaining" id="alertTime">Expira en: 1:00</div>
        <button id="closeAlert" style="margin-top: 20px;">ENTENDIDO</button>
    </div>

    <div class="modal" id="vipModal">
        <div class="modal-content">
            <h3 style="color: var(--vip); margin-bottom: 20px; text-align: center;">
                <i class="fas fa-crown"></i> Acceso VIP - 5000 CUP/mes
            </h3>
            <div style="text-align: left; margin: 20px 0; color: var(--text);">
                <p style="margin-bottom: 15px;"><i class="fas fa-check" style="color: var(--accent);"></i> Acceso a TODAS las señales sin límites</p>
                <p style="margin-bottom: 15px;"><i class="fas fa-check" style="color: var(--accent);"></i> Señales en tiempo real VIP</p>
                <p style="margin-bottom: 15px;"><i class="fas fa-check" style="color: var(--accent);"></i> Soporte prioritario 24/7</p>
                <p style="margin-bottom: 15px;"><i class="fas fa-check" style="color: var(--accent);"></i> Estadísticas avanzadas personalizadas</p>
                <p style="margin-bottom: 15px;"><i class="fas fa-check" style="color: var(--accent);"></i> Alertas instantáneas exclusivas</p>
                <p style="margin-bottom: 20px;"><i class="fas fa-check" style="color: var(--accent);"></i> Señales antes que los usuarios free</p>
            </div>
            <p style="text-align: center; margin: 20px 0; color: var(--text-secondary);">
                Duración: 30 días completos
            </p>
            <div style="text-align: center; margin: 25px 0;">
                <a href="https://t.me/Asche90" target="_blank" style="display: inline-block; background: linear-gradient(90deg, var(--vip), #ff9900); color: var(--dark); padding: 14px 30px; border-radius: 8px; font-weight: 700; text-decoration: none; transition: all 0.3s ease; font-size: 1.1rem;">
                    <i class="fab fa-telegram"></i> Contactar al administrador
                </a>
            </div>
            <p style="text-align: center; margin: 15px 0; color: var(--text-secondary); font-size: 0.9rem;">
                Envíale un mensaje solicitando el plan VIP
            </p>
            <button id="closeVipModal" style="background: transparent; border: 1px solid var(--vip); color: var(--vip); margin-top: 10px;">
                CERRAR
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="script.js"></script>
</body>
</html>
